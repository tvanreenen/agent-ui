<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Agent UI 2 - AG-UI Protocol Demo</title>
    <link rel="stylesheet" href="demo.css">
    <script src="demo.js"></script>
</head>
<body>
    <div class="container">
        <div class="demo-section">
            <h2>AG-UI Protocol Implementation</h2>
            <p>AG-UI protocol communication with full event handling:</p>
            <div class="code-block">
// First, install AG-UI SDK: npm install @ag-ui/client
import { HttpAgent } from '@ag-ui/client';

// Listen for messages
widget.addEventListener('message', (e) => {
    console.log('AG-UI message:', e.detail.query);
    
    // Initialize AG-UI agent
    const agent = new HttpAgent({
        url: 'https://your-ag-ui-server.com/agent',
        headers: { 'Authorization': 'Bearer your-api-key' }
    });
    
    // Handle all AG-UI events
    agent.runAgent({
        runId: `run_${Date.now()}`,
        messages: [{ role: 'user', content: e.detail.query }]
    }).subscribe({
        next: (event) => {
            switch (event.type) {
                case 'RUN_STARTED':
                    widget.setTyping(true);
                    widget.setSubmittable(false);
                    break;
                    
                case 'TEXT_MESSAGE_START':
                    widget.appendToLastMessage('');
                    break;
                    
                case 'TEXT_MESSAGE_CONTENT':
                    widget.appendToLastMessage(event.delta);
                    break;
                    
                case 'TEXT_MESSAGE_END':
                    // Message completed - no action needed
                    break;
                    
                case 'TOOL_CALL_START':
                    widget.appendToLastMessage(`ðŸ”§ Calling tool: ${event.toolCallName}`);
                    break;
                    
                case 'TOOL_CALL_ARGS':
                    // Tool arguments being streamed - could show in UI
                    break;
                    
                case 'TOOL_CALL_END':
                    // Tool call completed - no action needed
                    break;
                    
                case 'TOOL_CALL_RESULT':
                    widget.appendToLastMessage(`âœ… Tool result: ${event.content}`);
                    break;
                    
                case 'STATE_SNAPSHOT':
                    updateAppState(event.snapshot);
                    break;
                    
                case 'STATE_DELTA':
                    applyStateDelta(event.delta);
                    break;
                    
                case 'MESSAGES_SNAPSHOT':
                    // Load complete conversation history
                    event.messages.forEach(message => {
                        widget.addMessage(message);
                    });
                    break;
                    
                case 'RUN_FINISHED':
                    widget.setTyping(false);
                    widget.setSubmittable(true);
                    break;
                    
                case 'RUN_ERROR':
                    widget.setTyping(false);
                    widget.setSubmittable(true);
                    widget.appendToLastMessage(`âŒ Error: ${event.message}`);
                    break;
                    
                default:
                    console.log('Unhandled event type:', event.type);
                    break;
            }
        },
        complete: () => {
            widget.setTyping(false);
            widget.setSubmittable(true);
        },
        error: (error) => {
            widget.setTyping(false);
            widget.setSubmittable(true);
            widget.appendToLastMessage('Error: ' + error.message);
        }
    });
});
            </div>
        </div>

        <div class="demo-section">
            <h2>AG-UI SDK Installation</h2>
            <p>To use AG-UI protocol, you need to install the AG-UI SDK:</p>
            <div class="code-block">
npm install @ag-ui/client
npm install @ag-ui/core
npm install rxjs
            </div>
            
            <p><strong>Or load directly in the browser:</strong></p>
            <div class="code-block">
// Import directly from CDN (if the SDK supports ES modules)
import { HttpAgent } from 'https://unpkg.com/@ag-ui/client@latest/dist/index.esm.js';
import { EventType } from 'https://unpkg.com/@ag-ui/core@latest/dist/index.esm.js';
            </div>
        </div>

        <div class="demo-section">
            <h2>Event Log</h2>
            <div id="eventLog" class="log"></div>
        </div>
    </div>

    <agent-ui-2 placeholder-text="Ask me anything..."></agent-ui-2>
    <script src="agent-ui-2.umd.js"></script>
    
    <script>
        const widget = document.querySelector('agent-ui-2');
        widget.conversationTitle = 'AG-UI Demo';
        widget.addEventListener('message', (e) => {
            logEvent(`User asked: "${e.detail.query}"`, 'info');
            widget.setTyping(true);
            widget.setSubmittable(false);
            setTimeout(() => {
                widget.setTyping(false);
                widget.appendToLastMessage(getRandomResponse());
                widget.setSubmittable(true);
            }, 2000);
        });
        logEvent('Widget initialized', 'info');
    </script>
</body>
</html> 